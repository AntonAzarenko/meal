group 'com.azarenka'
version '0.1-SNAPSHOT'
repositories {
    mavenCentral()
}
buildscript {
    ext {
        //springBootVersion = rev_spring_boot
        herokuPluginVersion = rev_heroku_plugin
    }

    repositories {
        mavenCentral()
        maven {
            url "https://plugins.gradle.org/m2/"
        }
    }
    dependencies {
        classpath("gradle.plugin.com.heroku.sdk:heroku-gradle:${herokuPluginVersion}")
    }
}

apply plugin: 'java'
apply plugin: 'war'


/*heroku {
    appName = "meal"
    processTypes(
            web: "cd build ; java -Dgrails.env=prod -jar ../build/server/webapp-runner-*.jar --expand-war --port=\$PORT libs/*.war".toString()
           //web: "java \$JAVA_OPTS -jar -Dspring.profiles.active=production $buildDir.name/libs/$war.archiveName --server.port=\$PORT".toString()
    )
}*/

dependencies {
    compile group: 'com.github.jsimone', name: 'webapp-runner', version: '9.0.24.0'

}

task stage() {
    dependsOn clean, war
}


task copyToLib(type: Copy) {
    into "$buildDir/libs"
    from(configurations.compile) {
        include "webapp-runner*"
    }
}

stage.dependsOn(copyToLib)

